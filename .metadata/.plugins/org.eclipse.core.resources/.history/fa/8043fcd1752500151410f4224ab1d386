/**
 * New node file
 */

var RifCSCollection = require('./RifCSCollection.js').RifCSCollection,
	RifCSParty = require('./RifCSParty.js').RifCSParty,
	RifCSActivity = require('./RifCSActivity.js').RifCSActivity,
	RifCSService = require('./RifCSService.js').RifCSService;

function isArray(v) {
    return Array.isArray ? Array.isArray(v) : Object.prototype.toString.call( v ) === '[object Array]';
}

function getFirstObject(v) {
	return isArray(v) ? v[0] : v;
}

function RifCSRecord(record) {
	this.record = record;
}

RifCSRecord.prototype.group = function() {
	return this.record.$.group;
};

RifCSRecord.prototype.key = function() {
	return typeof this.record.key[0]._ !== 'undefined' ? this.record.key[0]._ : this.record.key[0];
};

RifCSRecord.prototype.originatingSource = function() {
	return typeof this.record.originatingSource[0]._ !== 'undefined' ? this.record.originatingSource[0]._ : this.record.originatingSource[0];
};

RifCSRecord.prototype.isCollection = function() {
	return typeof this.record.collection !== 'undefined';
};

RifCSRecord.prototype.isParty = function() {
	return typeof this.record.party !== 'undefined';
};

RifCSRecord.prototype.isService = function() {
	return typeof this.record.service !== 'undefined';
};

RifCSRecord.prototype.isActivity = function() {
	return typeof this.record.activity !== 'undefined';
};

RifCSRecord.prototype.asCollection = function() {
	return this.isCollection() ? new RifCSCollection(getFirstObject(this.record.collection)) : null;
};

RifCSRecord.prototype.asParty = function() {
	return this.isParty() ? new RifCSParty(getFirstObject(this.record.party)) : null;
};

RifCSRecord.prototype.asService = function() {
	return this.isService() ? new RifCSService(getFirstObject(this.record.sevice)) : null;
};

RifCSRecord.prototype.asActivity = function() {
	return this.isActivity() ? new RifCSActivity(getFirstObject(this.record.activity)) : null;
};

exports.RifCSRecord = RifCSRecord;